<!DOCTYPE html>
<html>
<head>
    <title>Forums</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
</head>
<body>
    <h1>Create a Forum</h1>
    <form action="/addforum" method="post">

        <label for="user_id">User ID:</label><br>
        <input type="text" id="user_id" name="user_id"><br>

        <label for="title">Title:</label><br>
        <input type="text" id="title" name="title"><br>

        <label for="content">Content:</label><br>
        <textarea id="content" name="content"></textarea><br>

        <button type="submit">Create Forum</button>
    </form>

    <h1>Forums</h1>
    <div id="forums">
    </div>

    <script>
        fetch('/forums')
            .then(response => response.json())
            .then(data => {
                let forumContainer = document.getElementById('forums');
                data.forEach(forum => {
                    let forumElement = document.createElement('div');
                    forumElement.innerHTML = `
                        <div class="card">
                            <div class="card-header">
                                <h4>Forum Title: ${forum.title}</h4>
                                <p>Posted by: ${forum.user_id}</p>
                            </div>
                            <div class="card-body">
                                <p class="content"> <h3>Forum Content</h3> ${forum.content} </p>


                                </div>


                                    <div class="card">
                                        <h3>Comments</h3>
                                <div id="comments-${forum.id}"></div>
                                 <form action="/addcomment" method="post">
                            <input type="hidden" name="forum_id" value="${forum.id}">

                            <label for="user_id">User ID:</label><br>
                            <input type="text" id="user_id" name="user_id"><br>


                            <label for="content">Comment:</label><br>
                            <textarea id="content" name="content"></textarea><br>

                            
                            <button type="submit" class="btn btn-primary">Add Comment</button>
                        </form>
                         
                            </div>
                        </div>
                    `;
                    forumContainer.appendChild(forumElement);

                    fetch(`/comments/${forum.id}`)
                        .then(response => response.json())
                        .then(comments => {
                            let commentContainer = document.getElementById(`comments-${forum.id}`);
                            comments.forEach(comment => {
                                let commentElement = document.createElement('p');
                                commentElement.innerHTML = `<strong>${comment.user_id}:</strong> ${comment.content}`;
                                commentContainer.appendChild(commentElement);
                            });
                        });
                });
            });
    </script>
</body>
</html>